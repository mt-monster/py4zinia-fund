# 高级筛选功能使用指南

## 功能概述

高级筛选功能提供了专业级的基金筛选能力，参考同花顺、东方财富网、雪球等主流金融平台设计，支持多条件组合筛选、实时结果更新、预设筛选条件等特性。

## 筛选条件类型

### 1. 基金类型（多选）

支持同时选择多个基金类型：
- **股票型** - 主要投资股票，风险收益较高
- **债券型** - 主要投资债券，稳健收益
- **混合型** - 股债混合配置
- **货币型** - 低风险现金管理工具
- **指数型** - 被动跟踪指数表现
- **QDII** - 海外投资基金
- **ETF** - 交易所交易基金
- **FOF** - 基金中的基金

### 2. 风险等级（多选）

根据最大回撤和波动率自动计算：
- **R1 低风险** - 回撤<5%，如货币基金
- **R2 中低风险** - 回撤5-15%，如债券基金
- **R3 中风险** - 回撤15-25%，如混合基金
- **R4 中高风险** - 回撤25-35%，如股票基金
- **R5 高风险** - 回撤>35%，如行业主题基金

### 3. 成立时间（单选）

- 不限
- 1年以内
- 1-3年
- 3-5年
- 5年以上

### 4. 基金规模（单选）

- 不限
- 1亿以下
- 1-10亿
- 10-50亿
- 50-100亿
- 100亿以上

### 5. 收益率（范围 + 时间段）

支持8个时间段：
- 今日
- 近1周
- 近1月
- 近3月
- 近6月
- 近1年
- 今年来
- 成立以来

快捷选项：
- 亏损
- 0-10%
- 10-20%
- 20%+

### 6. 夏普比率（范围）

衡量风险调整后收益：
- < 1：收益风险比较低
- 1-2：较好
- > 2：优秀

### 7. 最大回撤（范围）

衡量风险控制能力：
- 0-10%：风险控制优秀
- 10-20%：良好
- 20-30%：一般
- > 30%：风险较高

### 8. 波动率（范围）

衡量价格波动程度：
- < 10%：低波动
- 10-20%：中等波动
- > 20%：高波动

### 9. 单位净值（范围）

按当前净值筛选：
- 最低值 - 最高值

### 10. 持仓金额（范围）

按个人持仓金额筛选：
- 最低值 - 最高值

## 预设筛选条件

系统内置6种常用筛选方案：

| 预设名称 | 筛选条件 | 适用场景 |
|---------|---------|---------|
| 全部基金 | 无限制 | 查看所有持仓 |
| 高收益基金 | 年化收益>20% | 寻找高收益机会 |
| 稳健基金 | 回撤<10%，夏普>1 | 风险控制优先 |
| 指数基金 | ETF或指数型 | 被动投资配置 |
| 海外配置 | QDII基金 | 分散地域风险 |
| 债券基金 | 债券型 | 稳健收益配置 |

## 使用方法

### 打开筛选面板

1. 点击工具栏"高级筛选"按钮
2. 或按快捷键 `Ctrl + F`

### 设置筛选条件

1. **选择预设**：点击顶部的预设标签快速应用常用筛选
2. **自定义筛选**：在各项筛选条件中选择或输入值
3. **多条件组合**：可同时设置多个筛选条件

### 查看筛选结果

- 筛选结果实时更新
- 筛选条件以标签形式显示在表格上方
- 底部显示"显示 X / Y 只基金"

### 清除筛选

- 点击单个筛选条件标签上的 × 移除该条件
- 点击"清除全部"按钮重置所有条件
- 点击筛选区块标题旁的清除图标移除该区块条件

## 筛选技巧

### 技巧1：渐进式筛选

1. 先选择基金类型缩小范围
2. 再添加风险等级条件
3. 最后根据收益率精确定位

### 技巧2：逆向筛选

使用排除法：
- 不想看到货币基金？不选"货币型"
- 不想看到高风险基金？只选R1-R3风险等级

### 技巧3：时间段对比

同时查看不同时间段的收益率：
- 近1年表现好 + 今年以来表现差 = 可能回调
- 近1年差 + 今年好 = 可能反转

### 技巧4：量化指标组合

- 夏普比率>1 + 回撤<20% = 风险调整后收益良好
- 年化>15% + 波动率<25% = 高收益低波动

## 性能优化

### 防抖处理

筛选条件变更后300ms才执行筛选，避免频繁计算。

### 本地计算

所有筛选在浏览器本地完成，无需等待服务器响应。

### 大数据量优化

- 使用高效的数组过滤算法
- 筛选耗时<100ms（1000只基金）

## 界面交互

### 键盘快捷键

| 快捷键 | 功能 |
|-------|------|
| Ctrl + F | 打开/关闭筛选面板 |
| ESC | 关闭筛选面板 |

### 响应式设计

- 桌面端：右侧滑出面板，宽380px
- 移动端：全屏面板，优化触控

## 故障排除

### 筛选无结果

1. 检查筛选条件是否过于严格
2. 点击"清除全部"重新开始
3. 检查基金数据是否加载成功

### 筛选条件无法清除

1. 点击筛选区块标题旁的清除图标
2. 或直接点击"清除全部"

### 筛选面板无法打开

1. 检查是否已选中基金数据
2. 刷新页面重试
3. 查看浏览器控制台是否有错误

## 开发者说明

### 数据结构

筛选条件存储在 `FundFilters.currentFilters` 对象中：

```javascript
{
    fundType: ['stock', 'hybrid'],      // 多选
    riskLevel: ['low', 'mid'],           // 多选
    establishDate: '3y-5y',              // 单选
    returnRate: {                        // 分组范围
        period: 'year',
        year: { min: 10, max: 30 }
    },
    sharpeRatio: { min: 1, max: 3 },     // 范围
    maxDrawdown: { min: -30, max: -10 }
}
```

### 添加新筛选条件

在 `filterDefinitions` 中添加配置：

```javascript
newFilter: {
    label: '新筛选',
    type: 'multiSelect',  // multiSelect | singleSelect | range | rangeGroup
    options: [
        { value: 'option1', label: '选项1' },
        { value: 'option2', label: '选项2' }
    ]
}
```

在 `executeFilter` 中添加筛选逻辑：

```javascript
if (filters.newFilter?.length > 0) {
    if (!filters.newFilter.includes(fund.someProperty)) {
        return false;
    }
}
```

## 更新日志

### 2026-02-09
- 初始版本发布
- 支持10种筛选条件
- 6种预设筛选方案
- 实时筛选结果更新
