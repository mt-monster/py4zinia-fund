# å®¢æˆ·æµå¤±é¢„è­¦ Agent ç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº **AI Agent** æ¶æ„çš„å®¢æˆ·æµå¤±é¢„è­¦ä¸æŒ½ç•™è®¡åˆ’ç”Ÿæˆç³»ç»Ÿã€‚ç³»ç»Ÿé‡‡ç”¨æ™ºèƒ½ Agent è®¾è®¡ï¼Œå…·å¤‡è‡ªä¸»å†³ç­–ã€ä»»åŠ¡è§„åˆ’ã€è®°å¿†ç®¡ç†ç­‰èƒ½åŠ›ï¼Œèƒ½å¤Ÿç†è§£è‡ªç„¶è¯­è¨€æŒ‡ä»¤å¹¶è‡ªåŠ¨æ‰§è¡Œå¤æ‚çš„æµå¤±é¢„è­¦ä»»åŠ¡ã€‚

### ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **ğŸ¤– AI Agent æ¶æ„**ï¼šå…·å¤‡è‡ªä¸»å†³ç­–ã€è§„åˆ’ã€è®°å¿†ç­‰æ™ºèƒ½èƒ½åŠ›
- **ğŸ’¬ è‡ªç„¶è¯­è¨€äº¤äº’**ï¼šæ”¯æŒå¯¹è¯å¼æ“ä½œï¼Œæ— éœ€è®°å¿†å¤æ‚å‘½ä»¤
- **ğŸ”§ å·¥å…·ç³»ç»Ÿ**ï¼šæ¨¡å—åŒ–å·¥å…·è®¾è®¡ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **ğŸ“Š æ•°æ®ç”Ÿæˆä¸æ¨¡æ‹Ÿ**ï¼šç”ŸæˆçœŸå®çš„è¯åˆ¸å®¢æˆ·è¡Œä¸ºæ•°æ®é›†
- **ğŸ¯ æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ**ï¼šåŸºäºXGBoostè®­ç»ƒå®¢æˆ·æµå¤±é¢„æµ‹æ¨¡å‹
- **ğŸ“ˆ SHAPå¯è§£é‡Šæ€§åˆ†æ**ï¼šå¯è§†åŒ–å…³é”®æµå¤±é©±åŠ¨å› ç´ 
- **âš ï¸ é£é™©å®¢æˆ·é¢„æµ‹**ï¼šæ‰¹é‡è¯†åˆ«é«˜æµå¤±é£é™©å®¢æˆ·
- **ğŸ ä¸ªæ€§åŒ–æŒ½ç•™è®¡åˆ’**ï¼šåˆ©ç”¨å¤§æ¨¡å‹ç”Ÿæˆé’ˆå¯¹æ€§çš„å®¢æˆ·æŒ½ç•™ç­–ç•¥
- **ğŸŒ Webç•Œé¢äº¤äº’**ï¼šæä¾›ç›´è§‚çš„å‰ç«¯æ“ä½œç•Œé¢
- **ğŸ”Œ RESTful API**ï¼šæ”¯æŒç³»ç»Ÿé›†æˆä¸äºŒæ¬¡å¼€å‘

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ç•Œé¢ (index.html)                      â”‚
â”‚                     Web UI + å¯¹è¯äº¤äº’ç•Œé¢                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Flask API æœåŠ¡å±‚ (app.py)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ RESTful API  â”‚  â”‚ Agent Chat   â”‚  â”‚ å…¼å®¹æ—§æ¥å£    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI Agent æ ¸å¿ƒå±‚ (agent.py)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ å†³ç­–è§„åˆ’     â”‚  â”‚ è®°å¿†ç®¡ç†     â”‚  â”‚ å·¥å…·è°ƒç”¨     â”‚          â”‚
â”‚  â”‚ Planning     â”‚  â”‚ Memory       â”‚  â”‚ Tool Calling â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å·¥å…·ç³»ç»Ÿå±‚ (tools.py)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ æ•°æ®ç”Ÿæˆ     â”‚  â”‚ æ¨¡å‹è®­ç»ƒ     â”‚  â”‚ é£é™©é¢„æµ‹     â”‚          â”‚
â”‚  â”‚ SHAPåˆ†æ     â”‚  â”‚ æŒ½ç•™è®¡åˆ’     â”‚  â”‚ æŠ¥å‘Šç”Ÿæˆ     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®å¤„ç†å±‚ (churn_predict.py)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ XGBoostæ¨¡å‹  â”‚  â”‚ ç‰¹å¾å·¥ç¨‹     â”‚  â”‚ æ•°æ®ç”Ÿæˆ     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆ

### åç«¯

- Python 3.12
- Flask 2.x - Webæ¡†æ¶
- XGBoost - æœºå™¨å­¦ä¹ æ¨¡å‹
- SHAP - æ¨¡å‹è§£é‡Šå·¥å…·
- Pandas, NumPy - æ•°æ®å¤„ç†
- scikit-learn - æœºå™¨å­¦ä¹ åº“
- Matplotlib, Seaborn - æ•°æ®å¯è§†åŒ–

### å‰ç«¯

- HTML5/CSS3
- JavaScript (ES6+)
- Bootstrap 5 - UIæ¡†æ¶
- Axios - HTTPå®¢æˆ·ç«¯

### å¤§æ¨¡å‹é›†æˆ

- å­—èŠ‚è·³åŠ¨æ–¹èˆŸå¤§æ¨¡å‹ API - ä¸ªæ€§åŒ–æŒ½ç•™è®¡åˆ’ç”Ÿæˆ

## å®‰è£…ä¸è¿è¡Œ

### ç¯å¢ƒå‡†å¤‡

1. ç¡®ä¿å·²å®‰è£…Python 3.10æˆ–ä»¥ä¸Šç‰ˆæœ¬
2. å®‰è£…ä¾èµ–åŒ…ï¼š

```bash
pip install -r requirements.txt
```

æˆ–è€…æ‰‹åŠ¨å®‰è£…ï¼š

```bash
pip install flask flask-cors pandas numpy matplotlib seaborn scikit-learn xgboost shap openai openpyxl python-dotenv
```

3. ï¼ˆå¯é€‰ï¼‰é…ç½®ç¯å¢ƒå˜é‡ï¼š

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š

```bash
# LLM API é…ç½®
LLM_API_KEY=your_api_key_here
LLM_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
LLM_MODEL=kimi-k2-thinking-251104

# æ•°æ®é…ç½®
N_CUSTOMERS=3000
N_WEEKS=12

# Agent é…ç½®
ENABLE_LLM=true
```

### è¿è¡Œç³»ç»Ÿ

#### æ–¹å¼ä¸€ï¼šå¯åŠ¨ Web æœåŠ¡ï¼ˆæ¨èï¼‰

**æœ€ç®€å•çš„æ–¹å¼**

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd customer_churn_predict

# 2. å¯åŠ¨ Flask åº”ç”¨
python app.py
```

**è®¿é—®ç•Œé¢**ï¼š

- ä¸»ç•Œé¢ï¼š`http://localhost:8000`
- Agent å¯¹è¯ç•Œé¢ï¼š`http://localhost:8000/agent`

**åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨**ï¼š

1. æ‰“å¼€ http://localhost:8000/agent
2. åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š
   - "è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹"
   - "é¢„æµ‹ä¸€ä¸‹å“ªäº›å®¢æˆ·æœ‰æµå¤±é£é™©"
   - "ç”Ÿæˆä¸€ä»½åˆ†ææŠ¥å‘Š"

**ä½¿ç”¨ cURL è°ƒç”¨ API**ï¼š

```bash
# ä¸ Agent å¯¹è¯
curl -X POST http://localhost:8000/api/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹"}'

# æŸ¥è¯¢ Agent çŠ¶æ€
curl http://localhost:8000/api/agent/status

# æŸ¥çœ‹ Agent è®°å¿†
curl http://localhost:8000/api/agent/memory?limit=10
```

**ä½¿ç”¨ Python è°ƒç”¨ API**ï¼š

```python
import requests

# ä¸ Agent å¯¹è¯
response = requests.post(
    'http://localhost:8000/api/agent/chat',
    json={'message': 'è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹'}
)
print(response.json())

# æŸ¥è¯¢çŠ¶æ€
response = requests.get('http://localhost:8000/api/agent/status')
print(response.json())
```

#### æ–¹å¼äºŒï¼šç›´æ¥ä½¿ç”¨ Python ä»£ç 

**è¿è¡Œç¤ºä¾‹è„šæœ¬**ï¼š

```bash
cd customer_churn_predict
python start_agent.py
```

**åœ¨ä»£ç ä¸­ä½¿ç”¨**ï¼š

```python
from agent.core import ChurnPredictionAgent
from tools import get_tools
from config.settings import get_config

# åˆå§‹åŒ–
config = get_config()
agent = ChurnPredictionAgent(config=config['llm'])
tools = get_tools()

# æ³¨å†Œå·¥å…·
agent.register_tool('generate_data', tools.generate_data, 'ç”Ÿæˆå®¢æˆ·æ•°æ®')
agent.register_tool('train_model', tools.train_model, 'è®­ç»ƒæµå¤±é¢„æµ‹æ¨¡å‹')
agent.register_tool('predict_risk', tools.predict_risk, 'é¢„æµ‹å®¢æˆ·æµå¤±é£é™©')

# ä¸ Agent å¯¹è¯
response = agent.chat("è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹")
print(response['response'])

# æŸ¥çœ‹çŠ¶æ€
status = agent.get_status()
print(status)
```

#### æ–¹å¼ä¸‰ï¼šä½¿ç”¨ Docker

1. æ„å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼š

```bash
docker-compose up -d
```

2. æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
docker-compose logs -f
```

3. è®¿é—®æœåŠ¡ï¼š

   - ä¸»ç•Œé¢: http://localhost:8000
   - Agent ç•Œé¢: http://localhost:8000/agent
4. åœæ­¢æœåŠ¡ï¼š

```bash
docker-compose down
```

## Agent ä½¿ç”¨æŒ‡å—

### Agent å¯¹è¯æ¥å£

Agent æ”¯æŒè‡ªç„¶è¯­è¨€äº¤äº’ï¼Œæ‚¨å¯ä»¥ç›´æ¥ç”¨ä¸­æ–‡æè¿°éœ€æ±‚ï¼ŒAgent ä¼šè‡ªåŠ¨ç†è§£å¹¶æ‰§è¡Œç›¸åº”ä»»åŠ¡ã€‚

#### ç¤ºä¾‹å¯¹è¯

```bash
# è®­ç»ƒæ¨¡å‹
ç”¨æˆ·: "è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹"
Agent: æˆ‘å·²ç»ä¸ºæ‚¨åˆ¶å®šäº†æ‰§è¡Œè®¡åˆ’ï¼ŒåŒ…å« 4 ä¸ªæ­¥éª¤ï¼š
  1. ç”Ÿæˆå®¢æˆ·æ•°æ®
  2. è¿›è¡Œç‰¹å¾å·¥ç¨‹
  3. è®­ç»ƒæµå¤±é¢„æµ‹æ¨¡å‹
  4. è¿›è¡Œæ¨¡å‹å¯è§£é‡Šæ€§åˆ†æ

# é¢„æµ‹é£é™©
ç”¨æˆ·: "é¢„æµ‹ä¸€ä¸‹å“ªäº›å®¢æˆ·æœ‰æµå¤±é£é™©"
Agent: æˆ‘å·²ç»ä¸ºæ‚¨åˆ¶å®šäº†æ‰§è¡Œè®¡åˆ’ï¼ŒåŒ…å« 2 ä¸ªæ­¥éª¤ï¼š
  1. é¢„æµ‹å®¢æˆ·æµå¤±é£é™©
  2. ç”ŸæˆæŒ½ç•™è®¡åˆ’

# ç”ŸæˆæŠ¥å‘Š
ç”¨æˆ·: "ç”Ÿæˆä¸€ä»½åˆ†ææŠ¥å‘Š"
Agent: æˆ‘å·²ç»ä¸ºæ‚¨åˆ¶å®šäº†æ‰§è¡Œè®¡åˆ’ï¼ŒåŒ…å« 1 ä¸ªæ­¥éª¤ï¼š
  1. ç”Ÿæˆåˆ†ææŠ¥å‘Š
```

### Agent API æ¥å£

#### 1. Agent å¯¹è¯

- **URL**: `/api/agent/chat`
- **æ–¹æ³•**: `POST`
- **æè¿°**: ä¸ Agent è¿›è¡Œå¯¹è¯
- **è¯·æ±‚ä½“**:

```json
{
  "message": "è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹",
  "context": {}
}
```

- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "response": "æˆ‘å·²ç»ä¸ºæ‚¨åˆ¶å®šäº†æ‰§è¡Œè®¡åˆ’...",
  "plan": [...],
  "results": {...}
}
```

#### 2. Agent çŠ¶æ€æŸ¥è¯¢

- **URL**: `/api/agent/status`
- **æ–¹æ³•**: `GET`
- **æè¿°**: è·å– Agent å½“å‰çŠ¶æ€
- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "agent_status": {
    "capabilities": {...},
    "tools_count": 8,
    "memory_count": 15,
    "has_llm": true
  }
}
```

#### 3. Agent è®°å¿†æŸ¥è¯¢

- **URL**: `/api/agent/memory`
- **æ–¹æ³•**: `GET`
- **æè¿°**: è·å– Agent å†å²è®°å¿†
- **å‚æ•°**: `limit` (å¯é€‰ï¼Œé»˜è®¤10)
- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "memory": "[2025-01-01T10:00:00] train_model: æ‰§è¡ŒæˆåŠŸ...",
  "memory_count": 15
}
```

#### 4. æ¸…ç©º Agent è®°å¿†

- **URL**: `/api/agent/memory/clear`
- **æ–¹æ³•**: `POST`
- **æè¿°**: æ¸…ç©º Agent çš„æ‰€æœ‰è®°å¿†

## APIæ¥å£è¯´æ˜

### 1. å¥åº·æ£€æŸ¥

- **URL**: `/api/health`
- **æ–¹æ³•**: `GET`
- **æè¿°**: æ£€æŸ¥APIæœåŠ¡å™¨è¿è¡ŒçŠ¶æ€
- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "ok",
  "message": "APIæœåŠ¡å™¨è¿è¡Œæ­£å¸¸"
}
```

### 2. æ¨¡å‹è®­ç»ƒ

- **URL**: `/api/train`
- **æ–¹æ³•**: `POST`
- **æè¿°**: ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®å¹¶è®­ç»ƒæµå¤±é¢„æµ‹æ¨¡å‹
- **è¯·æ±‚ä½“**:

```json
{
  "n_customers": 3000,
  "n_weeks": 12
}
```

- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "message": "æ¨¡å‹è®­ç»ƒå®Œæˆ",
  "customer_count": 3000,
  "feature_count": 29
}
```

### 3. é£é™©é¢„æµ‹

- **URL**: `/api/predict`
- **æ–¹æ³•**: `POST`
- **æè¿°**: é¢„æµ‹å®¢æˆ·æµå¤±é£é™©å¹¶ç”ŸæˆæŒ½ç•™è®¡åˆ’
- **è¯·æ±‚ä½“**:

```json
{
  "top_k": 30
}
```

- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "high_risk_count": 30,
  "plans_count": 30,
  "retention_plans": [...]
}
```

### 4. å®¢æˆ·ä¿¡æ¯æŸ¥è¯¢

- **URL**: `/api/customer/<customer_id>`
- **æ–¹æ³•**: `GET`
- **æè¿°**: è·å–å•ä¸ªå®¢æˆ·çš„è¯¦ç»†ä¿¡æ¯
- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "customer_info": {...}
}
```

### 5. æŒ½ç•™è®¡åˆ’ä¸‹è½½

- **URL**: `/api/plans/download`
- **æ–¹æ³•**: `GET`
- **æè¿°**: ä¸‹è½½æŒ½ç•™è®¡åˆ’Excelæ–‡ä»¶
- **å“åº”ç¤ºä¾‹**:

```json
{
  "status": "success",
  "plans": [...]
}
```

## ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ä½¿ç”¨æµç¨‹

1. **å¯åŠ¨ç³»ç»Ÿ**ï¼šè¿è¡Œ `python app.py`å¯åŠ¨æœåŠ¡å™¨
2. **è®¿é—®ç•Œé¢**ï¼šæ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8000`
3. **è®­ç»ƒæ¨¡å‹**ï¼šç‚¹å‡»"è®­ç»ƒæ¨¡å‹"æŒ‰é’®ï¼Œç³»ç»Ÿå°†ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®å¹¶è®­ç»ƒæ¨¡å‹
4. **æŸ¥çœ‹ç‰¹å¾é‡è¦æ€§**ï¼šæ¨¡å‹è®­ç»ƒå®Œæˆåï¼Œé¡µé¢å°†æ˜¾ç¤ºSHAPç‰¹å¾é‡è¦æ€§åˆ†æ
5. **é¢„æµ‹é£é™©ä¸ç”Ÿæˆè®¡åˆ’**ï¼šç‚¹å‡»"é¢„æµ‹ä¸ç”Ÿæˆè®¡åˆ’"æŒ‰é’®ï¼Œç³»ç»Ÿå°†è¯†åˆ«é«˜é£é™©å®¢æˆ·å¹¶ç”ŸæˆæŒ½ç•™ç­–ç•¥
6. **æŸ¥çœ‹ç»“æœ**ï¼šåœ¨é¡µé¢ä¸ŠæŸ¥çœ‹é¢„æµ‹ç»“æœå’ŒæŒ½ç•™è®¡åˆ’ï¼Œæˆ–ä¸‹è½½Excelæ–‡ä»¶

### å¸¸ç”¨æŒ‡ä»¤ç¤ºä¾‹

#### è®­ç»ƒæ¨¡å‹

```python
# Python
agent.chat("è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹")

# cURL
curl -X POST http://localhost:8000/api/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "è¯·å¸®æˆ‘è®­ç»ƒä¸€ä¸ªæµå¤±é¢„æµ‹æ¨¡å‹"}'
```

#### é¢„æµ‹é£é™©

```python
# Python
agent.chat("é¢„æµ‹ä¸€ä¸‹å“ªäº›å®¢æˆ·æœ‰æµå¤±é£é™©")

# cURL
curl -X POST http://localhost:8000/api/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "é¢„æµ‹ä¸€ä¸‹å“ªäº›å®¢æˆ·æœ‰æµå¤±é£é™©"}'
```

#### ç”ŸæˆæŠ¥å‘Š

```python
# Python
agent.chat("ç”Ÿæˆä¸€ä»½åˆ†ææŠ¥å‘Š")

# cURL
curl -X POST http://localhost:8000/api/agent/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "ç”Ÿæˆä¸€ä»½åˆ†ææŠ¥å‘Š"}'
```

#### æŸ¥çœ‹çŠ¶æ€

```python
# Python
status = agent.get_status()
print(status)

# cURL
curl http://localhost:8000/api/agent/status
```

#### æŸ¥çœ‹è®°å¿†

```python
# Python
memory = agent.get_memory_summary(limit=10)
print(memory)

# cURL
curl http://localhost:8000/api/agent/memory?limit=10
```

### æ•…éšœæ’æŸ¥

#### 1. ç«¯å£è¢«å ç”¨

å¦‚æœ 8000 ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ `app.py` ä¸­çš„ç«¯å£å·ï¼š

```python
app.run(host='0.0.0.0', port=8001, debug=True)  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

#### 2. ä¾èµ–åŒ…ç¼ºå¤±

```bash
pip install -r requirements.txt
```

#### 3. æ¨¡å—å¯¼å…¥é”™è¯¯

ç¡®ä¿åœ¨ `customer_churn_predict` ç›®å½•ä¸‹è¿è¡Œï¼Œæˆ–è€…è®¾ç½® PYTHONPATHï¼š

```bash
export PYTHONPATH=$PYTHONPATH:/path/to/py4zinia
```

## æ–‡ä»¶ç»“æ„

```
py4zinia/
â”œâ”€â”€ customer_churn_predict/
â”‚   â”œâ”€â”€ agent/                      # Agent æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ core.py                 # Agent æ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ report_generator.py     # æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â”‚   â””â”€â”€ prompts.py              # Prompt æ¨¡æ¿
â”‚   â”œâ”€â”€ config/                     # é…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ settings.py             # é…ç½®é¡¹
â”‚   â”‚   â””â”€â”€ prompts.yaml            # Prompt é…ç½®
â”‚   â”œâ”€â”€ static/                      # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ css/
â”‚   â”‚       â””â”€â”€ style.css
â”‚   â”œâ”€â”€ templates/                   # æ¨¡æ¿æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ agent.html               # Agent é¡µé¢
â”‚   â”œâ”€â”€ app.py                       # Flask ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ churn_predict.py             # é¢„æµ‹æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ tools.py                     # å·¥å…·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ feature_translation.py       # ç‰¹å¾ç¿»è¯‘å·¥å…·
â”‚   â””â”€â”€ requirements.txt             # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                         # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/                   # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ models/                      # æ¨¡å‹æ–‡ä»¶
â”œâ”€â”€ reports/                         # æŠ¥å‘Šç›®å½•
â”œâ”€â”€ Dockerfile                       # Docker é…ç½®
â”œâ”€â”€ docker-compose.yml               # Docker Compose
â”œâ”€â”€ requirements.txt                 # ä¾èµ–åˆ—è¡¨ï¼ˆæ ¹ç›®å½•ï¼‰
â”œâ”€â”€ README.md                        # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ API.md                           # API æ–‡æ¡£
```

## å…³é”®åŠŸèƒ½æ¨¡å—

### 1. AI Agent æ ¸å¿ƒæ¨¡å— (`agent.py`)

- **è‡ªä¸»å†³ç­–**ï¼šæ ¹æ®ç”¨æˆ·æ„å›¾è‡ªåŠ¨é€‰æ‹©æ‰§è¡Œå·¥å…·
- **ä»»åŠ¡è§„åˆ’**ï¼šå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤
- **è®°å¿†ç®¡ç†**ï¼šè®°å½•å†å²æ“ä½œå’Œç»“æœï¼Œæ”¯æŒè®°å¿†æŸ¥è¯¢å’Œæ¸…ç©º
- **å·¥å…·è°ƒç”¨**ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰å¯ç”¨å·¥å…·
- **è‡ªç„¶è¯­è¨€äº¤äº’**ï¼šç†è§£ç”¨æˆ·æ„å›¾å¹¶ç”Ÿæˆå“åº”

### 2. å·¥å…·ç³»ç»Ÿæ¨¡å— (`tools.py`)

- **æ•°æ®ç”Ÿæˆå·¥å…·**ï¼šç”Ÿæˆæ¨¡æ‹Ÿå®¢æˆ·æ•°æ®
- **ç‰¹å¾å·¥ç¨‹å·¥å…·**ï¼šè¿›è¡Œç‰¹å¾æå–å’Œè½¬æ¢
- **æ¨¡å‹è®­ç»ƒå·¥å…·**ï¼šè®­ç»ƒæµå¤±é¢„æµ‹æ¨¡å‹
- **é£é™©é¢„æµ‹å·¥å…·**ï¼šé¢„æµ‹å®¢æˆ·æµå¤±é£é™©
- **SHAPåˆ†æå·¥å…·**ï¼šè¿›è¡Œæ¨¡å‹å¯è§£é‡Šæ€§åˆ†æ
- **æŒ½ç•™è®¡åˆ’å·¥å…·**ï¼šç”Ÿæˆä¸ªæ€§åŒ–æŒ½ç•™è®¡åˆ’
- **æŠ¥å‘Šç”Ÿæˆå·¥å…·**ï¼šç”Ÿæˆåˆ†ææŠ¥å‘Š

### 3. æ•°æ®ç”Ÿæˆæ¨¡å—

- ç”Ÿæˆ3000ä¸ªå®¢æˆ·çš„12å‘¨è¡Œä¸ºæ•°æ®
- åŒ…å«å®¢æˆ·ç±»å‹ã€é£é™©æ‰¿å—èƒ½åŠ›ã€èµ„äº§çŠ¶å†µç­‰29ä¸ªç‰¹å¾
- æ¨¡æ‹Ÿ30%çš„å®¢æˆ·æµå¤±è¡Œä¸ºæ¨¡å¼

### 4. æ¨¡å‹è®­ç»ƒæ¨¡å—

- ä½¿ç”¨XGBoostç®—æ³•è®­ç»ƒæµå¤±é¢„æµ‹æ¨¡å‹
- é‡‡ç”¨åˆ†å±‚æŠ½æ ·ç¡®ä¿è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ†å¸ƒä¸€è‡´
- å¤„ç†æ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œæå‡æ¨¡å‹æ€§èƒ½

### 5. SHAPåˆ†ææ¨¡å—

- ç”Ÿæˆç‰¹å¾é‡è¦æ€§æŸ±çŠ¶å›¾
- åˆ›å»ºSHAPå€¼æ•£ç‚¹å›¾
- ç»˜åˆ¶ç‰¹å¾ä¾èµ–å…³ç³»å›¾
- æ”¯æŒä¸­æ–‡ç‰¹å¾åç§°å±•ç¤º

### 6. æŒ½ç•™è®¡åˆ’ç”Ÿæˆæ¨¡å—

- è°ƒç”¨å­—èŠ‚è·³åŠ¨æ–¹èˆŸå¤§æ¨¡å‹APIç”Ÿæˆä¸ªæ€§åŒ–æŒ½ç•™ç­–ç•¥
- æ ¹æ®å®¢æˆ·é£é™©ç­‰çº§åˆ¶å®šä¸åŒä¼˜å…ˆçº§çš„è®¡åˆ’
- åŒ…å«ä¼˜æƒ åŠ›åº¦ã€æ²Ÿé€šè¯æœ¯å’Œé¢„æœŸæ•ˆæœ

## æ¨¡å‹æ€§èƒ½

- **AUC-ROC**: çº¦0.92ï¼ˆæµ‹è¯•é›†ï¼‰
- **å‡†ç¡®ç‡**: çº¦87%
- **å¬å›ç‡**: çº¦85%ï¼ˆé’ˆå¯¹æµå¤±å®¢æˆ·ï¼‰
- **F1åˆ†æ•°**: çº¦86%

## æ³¨æ„äº‹é¡¹

1. ç³»ç»Ÿé»˜è®¤ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”ç”¨æ—¶éœ€æ›¿æ¢ä¸ºçœŸå®å®¢æˆ·æ•°æ®
2. å¤§æ¨¡å‹è°ƒç”¨éœ€è¦æœ‰æ•ˆçš„å­—èŠ‚è·³åŠ¨æ–¹èˆŸå¤§æ¨¡å‹APIå¯†é’¥
3. æ¨¡å‹è®­ç»ƒå¯èƒ½éœ€è¦2-3åˆ†é’Ÿæ—¶é—´ï¼Œå…·ä½“å–å†³äºç³»ç»Ÿæ€§èƒ½
4. SHAPåˆ†æç»“æœä¼šè‡ªåŠ¨ä¿å­˜ä¸ºPNGå›¾åƒæ–‡ä»¶
5. æŒ½ç•™è®¡åˆ’å°†è‡ªåŠ¨ä¿å­˜ä¸ºExcelæ–‡ä»¶

## Agent æ‰©å±•ä¸å®šåˆ¶

### æ·»åŠ æ–°å·¥å…·

1. åœ¨ `tools.py` ä¸­çš„ `ChurnPredictionTools` ç±»ä¸­æ·»åŠ æ–°æ–¹æ³•ï¼š

```python
def your_new_tool(self, param1: str, param2: int) -> Dict[str, Any]:
    """æ–°å·¥å…·æè¿°"""
    try:
        # å®ç°å·¥å…·é€»è¾‘
        result = do_something(param1, param2)
        return {
            'status': 'success',
            'message': 'å·¥å…·æ‰§è¡ŒæˆåŠŸ',
            'result': result
        }
    except Exception as e:
        return {
            'status': 'error',
            'message': f'å·¥å…·æ‰§è¡Œå¤±è´¥: {str(e)}'
        }
```

2. åœ¨ `app.py` ä¸­æ³¨å†Œæ–°å·¥å…·ï¼š

```python
agent.register_tool('your_new_tool', tools.your_new_tool, 'æ–°å·¥å…·æè¿°')
```

### è‡ªå®šä¹‰ Agent è¡Œä¸º

1. **ä¿®æ”¹è§„åˆ’é€»è¾‘**ï¼šç¼–è¾‘ `agent.py` ä¸­çš„ `plan()` æ–¹æ³•
2. **è‡ªå®šä¹‰å“åº”ç”Ÿæˆ**ï¼šç¼–è¾‘ `agent.py` ä¸­çš„ `_generate_response()` æ–¹æ³•
3. **æ‰©å±•è®°å¿†åŠŸèƒ½**ï¼šåœ¨ `AgentMemory` ç±»ä¸­æ·»åŠ æ–°å­—æ®µ

### å…¶ä»–æ‰©å±•

1. **æ•°æ®é›†æˆ**ï¼šä¿®æ”¹ `generate_securities_data`å‡½æ•°ä»¥æ”¯æŒçœŸå®æ•°æ®æº
2. **æ¨¡å‹ä¼˜åŒ–**ï¼šè°ƒæ•´XGBoostå‚æ•°æˆ–å°è¯•å…¶ä»–æœºå™¨å­¦ä¹ ç®—æ³•
3. **ç•Œé¢å®šåˆ¶**ï¼šä¿®æ”¹ `index.html`ä»¥é€‚åº”ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚
4. **å¤§æ¨¡å‹æ›¿æ¢**ï¼šä¿®æ”¹ `generate_retention_strategy`å‡½æ•°ä»¥æ”¯æŒå…¶ä»–å¤§æ¨¡å‹

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œå¯è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤äººå‘˜ã€‚

---

---

**ç‰ˆæœ¬**: v2.0.0 (Agent ç‰ˆæœ¬)
**æ›´æ–°æ—¥æœŸ**: 2025-01-01
**ç»´æŠ¤è€…**: AIåŠ©æ‰‹
